(()=>{"use strict";class e{constructor(e){this.name=e.name,this.due=e.due,this.desc=e.desc,this.priority=e.priority,this.id=e.id,this.completed=!1}}class t{constructor(e,t,o=null){null==o?(this.name=e,this.tasks=[],this.id=t):(this.name=o.name,this.tasks=o.tasks,this.id=o.id)}add_task(e){this.tasks.push(e)}remove_task(e){this.tasks.splice(this.tasks.findIndex((t=>e.id==t.id)),1)}}const o=[];let[n,l]=function(){let e=JSON.parse(localStorage.getItem("projs"));return null==e||0==e.length?[1,-1]:[e[e.length-1].id+1,+localStorage.getItem("task_id")]}(),s=document.querySelector(".projects"),c=document.querySelector("#create-project button"),a=document.querySelector("#create-project input");function i(t){let n=document.createElement("div");n.classList.add("project"),n.id=t.id,s.append(n);let c=document.createElement("span");c.classList.add("title"),c.textContent=t.name;let a=document.createElement("ul");n.append(c,a,function(t){let n=document.createElement("div");n.classList.add("btn-container");let s=document.createElement("button");s.textContent="+ add task";let c=document.createElement("button");return c.textContent="- remove project",c.classList.add("red-button"),n.append(s,c),s.addEventListener("click",(s=>{let c=document.getElementById(t.id).querySelector("form");null==c?(c=document.createElement("form"),c.innerHTML='\n                <label for="task_name">Name: </label>\n                <input type="text" id="task_name" name="name" value="Ricky">\n                <label for="due">Due: </label>\n                <input type="date" id="due" name="due">\n                <label for="desc">Description: </label>\n                <textarea id="desc" cols="30" rows="10" name="desc"></textarea>\n                <label for="priority">Priority: </label>\n                <select id="priority" name="priority">\n                    <option>Low</option>\n                    <option selected>Medium</option>\n                    <option>High</option>\n                </select>\n                <button>Done</button>\n            ',c.addEventListener("submit",(n=>{n.preventDefault(),d(t,function(t,n){const s=t.querySelector("#task_name").value;let c=t.querySelector("#due").value;""==c&&(c="N/A");const a={name:s,due:c,desc:t.querySelector("#desc").value,priority:t.querySelector("#priority").value,id:l};t.remove();let i=new e(a);return console.log(`YOU JUST CREATED A TASK OF ID ${i.id} FOR PROJECT ${n.id}. WE ADDED TASK OBJECT TO ITS ARRAY`),n.add_task(i),console.log("PROJS:"),console.log(o),l--,localStorage.setItem("task_id",String(l)),localStorage.setItem("projs",JSON.stringify(o)),console.log("STORAGE:"),console.log(localStorage),console.log("------------------------"),i}(c,t))})),n.append(c)):c.classList.toggle("hidden")})),c.addEventListener("click",(e=>{o.splice(o.findIndex((e=>e.id==t.id)),1),document.getElementById(t.id).remove(),localStorage.setItem("projs",JSON.stringify(o)),console.log("YOU JUST DELETED A PROJECT, SO UPDATED PROJS"),console.log("PROJS:"),console.log(o),console.log("STORAGE:"),console.log(localStorage),console.log("------------------------")})),n}(t))}function d(e,t){let n=document.getElementById(e.id).querySelector("ul"),l=document.createElement("li");l.classList.add("task"),l.id=t.id,l.textContent=t.name,l.addEventListener("click",(s=>{const c=`[data-id="${l.id}"]`;let a=n.querySelector(c);if(null==a){a=document.createElement("div"),a.classList.add("task-clicked"),a.dataset.id=l.id;let n=document.createElement("div");n.style.cssText="display: flex; gap: 3px;";let s=document.createElement("button"),c=document.createElement("button");t.completed?(s.textContent="Mark unfinished",s.classList.add("red-button")):s.textContent="Mark finished",c.textContent="Delete task",c.classList.add("red-button");let i=document.createElement("span");i.textContent="Due: "+t.due;let d=document.createElement("span");d.textContent="Description: "+t.desc;let r=document.createElement("span");r.textContent="Priority: "+t.priority;const u=[i,d,r];if(t.completed)for(let e of u)e.classList.toggle("line-through");s.addEventListener("click",(n=>{console.log(`YOU JUST SET TASK OF ID ${t.id} AS COMPLETE FOR PROJECT ${e.id}`),t.completed=!t.completed,localStorage.setItem("projs",JSON.stringify(o)),console.log("STORAGE:"),console.log(localStorage),console.log("------------------------");for(let e of u)e.classList.toggle("line-through");s.classList.toggle("red-button"),s.textContent="Mark finished"==s.textContent?"Mark unfinished":"Mark finished"})),c.addEventListener("click",(n=>{console.log(`YOU JUST DELETED TASK OF ID ${t.id} FOR PROJECT ${e.id}. WE DELETED TASK OBJECT FROM ITS ARRAY`),e.remove_task(t),l.remove(),a.remove(),console.log("PROJS:"),console.log(o),localStorage.setItem("projs",JSON.stringify(o)),console.log("STORAGE:"),console.log(localStorage),console.log("------------------------")})),n.append(s,c),a.append(n,i,d,r),l.insertAdjacentElement("afterend",a)}else a.classList.toggle("hidden")})),n.append(l)}!function(){let e=JSON.parse(localStorage.getItem("projs"));if(null!=e){console.log("PREVIOUS PROJECTS:"),console.log(localStorage);for(let n of e){n=new t(n.name,n.id,n),o.push(n),i(n);for(let e of n.tasks)d(n,e)}}else console.log("no previous projects")}(),c.addEventListener("click",(e=>{let s;s=""==a.value?new t("untitled project",n):new t(a.value,n),n++,o.push(s),localStorage.setItem("task_id",String(l)),localStorage.setItem("projs",JSON.stringify(o)),console.log(`YOU JUST CREATED A PROJECT THAT HAS ID OF ${s.id}`),console.log(o),console.log(localStorage),console.log("------------------------"),i(s)}))})();