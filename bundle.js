(()=>{"use strict";class e{constructor(e){this.name=e.name,this.due=e.due,this.desc=e.desc,this.priority=e.priority,this.id=e.id,this.completed=!1}}class t{constructor(e,t,n=null){null==n?(this.name=e,this.tasks=[],this.id=t):(this.name=n.name,this.tasks=n.tasks,this.id=n.id)}add_task(e){this.tasks.push(e)}remove_task(e){this.tasks.splice(this.tasks.findIndex((t=>e.id==t.id)),1)}}const n=[];let[o,l]=function(){let e=JSON.parse(localStorage.getItem("projs"));return null==e||0==e.length?[1,-1]:[e[e.length-1].id+1,+localStorage.getItem("task_id")]}(),s=document.querySelector(".projects"),a=document.querySelector("#create-project button"),i=document.querySelector("#create-project input");function d(t){let o=document.createElement("div");o.classList.add("project"),o.id=t.id,s.append(o);let a=document.createElement("span");a.classList.add("title"),a.textContent=t.name;let i=document.createElement("ul");o.append(a,i,function(t){let o=document.createElement("div");o.classList.add("btn-container");let s=document.createElement("button");s.textContent="+ add task";let a=document.createElement("button");return a.textContent="- remove project",a.classList.add("red-button"),o.append(s,a),s.addEventListener("click",(s=>{!function(t,o){let s=document.getElementById(t.id).querySelector("form");null==s?(s=document.createElement("form"),s.innerHTML='\n            <label for="task_name">Name: </label>\n            <input type="text" id="task_name" name="name" value="Untitled task">\n            <label for="due">Due: </label>\n            <input type="date" id="due" name="due">\n            <label for="desc">Description: </label>\n            <textarea id="desc" cols="30" rows="10" name="desc"></textarea>\n            <label for="priority">Priority: </label>\n            <select id="priority" name="priority">\n                <option>Low</option>\n                <option selected>Medium</option>\n                <option>High</option>\n            </select>\n            <button>Done</button>\n        ',s.addEventListener("submit",(o=>{o.preventDefault(),c(t,function(t,o){const s=t.querySelector("#task_name").value;let a=t.querySelector("#due").value;""==a&&(a="N/A");const i={name:s,due:a,desc:t.querySelector("#desc").value,priority:t.querySelector("#priority").value,id:l};t.remove();let d=new e(i);return console.log(`YOU JUST CREATED A TASK OF ID ${d.id} FOR PROJECT ${o.id}. WE ADDED TASK OBJECT TO ITS ARRAY`),o.add_task(d),console.log("PROJS:"),console.log(n),l--,localStorage.setItem("task_id",String(l)),localStorage.setItem("projs",JSON.stringify(n)),console.log("STORAGE:"),console.log(localStorage),console.log("------------------------"),d}(s,t))})),o.append(s)):s.classList.toggle("hidden")}(t,o)})),a.addEventListener("click",(e=>{n.splice(n.findIndex((e=>e.id==t.id)),1),document.getElementById(t.id).remove(),localStorage.setItem("projs",JSON.stringify(n))})),o}(t))}function c(e,t){let o=document.getElementById(e.id).querySelector("ul"),l=document.createElement("li");l.classList.add("task"),l.id=t.id,l.textContent=t.name,l.addEventListener("click",(s=>{const a=`[data-id="${l.id}"]`;let i=o.querySelector(a);if(null==i){i=document.createElement("div"),i.classList.add("task-clicked"),i.dataset.id=l.id;let o=document.createElement("div");o.style.cssText="display: flex; gap: 3px;";let s=document.createElement("button"),a=document.createElement("button");t.completed?(s.textContent="Mark unfinished",s.classList.add("red-button")):s.textContent="Mark finished",a.textContent="Delete task",a.classList.add("red-button");let d=document.createElement("div"),c=document.createElement("span");c.textContent="Due: ",c.classList.add("task-info"),d.append(c),c.insertAdjacentText("afterend",t.due);let r=document.createElement("div"),u=document.createElement("span");u.textContent="Description: ",u.classList.add("task-info"),r.append(u),u.insertAdjacentText("afterend",t.desc);let m=document.createElement("div"),p=document.createElement("span");p.textContent="Priority: ",p.classList.add("task-info"),m.append(p),p.insertAdjacentText("afterend",t.priority);const g=[d,r,m];if(t.completed)for(let e of g)e.classList.toggle("line-through");s.addEventListener("click",(o=>{console.log(`YOU JUST SET TASK OF ID ${t.id} AS COMPLETE FOR PROJECT ${e.id}`),t.completed=!t.completed,localStorage.setItem("projs",JSON.stringify(n)),console.log("STORAGE:"),console.log(localStorage),console.log("------------------------");for(let e of g)e.classList.toggle("line-through");s.classList.toggle("red-button"),s.textContent="Mark finished"==s.textContent?"Mark unfinished":"Mark finished"})),a.addEventListener("click",(o=>{console.log(`YOU JUST DELETED TASK OF ID ${t.id} FOR PROJECT ${e.id}. WE DELETED TASK OBJECT FROM ITS ARRAY`),e.remove_task(t),l.remove(),i.remove(),console.log("PROJS:"),console.log(n),localStorage.setItem("projs",JSON.stringify(n)),console.log("STORAGE:"),console.log(localStorage),console.log("------------------------")})),o.append(s,a),i.append(o,d,r,m),l.insertAdjacentElement("afterend",i)}else i.classList.toggle("hidden")})),o.append(l)}!function(){let e=JSON.parse(localStorage.getItem("projs"));if(null!=e){console.log("PREVIOUS PROJECTS:"),console.log(localStorage);for(let o of e){o=new t(o.name,o.id,o),n.push(o),d(o);for(let e of o.tasks)c(o,e)}}}(),a.addEventListener("click",(e=>{let s;s=""==i.value?new t("untitled project",o):new t(i.value,o),o++,n.push(s),localStorage.setItem("task_id",String(l)),localStorage.setItem("projs",JSON.stringify(n)),d(s)}))})();