(()=>{"use strict";class e{constructor(e){this.name=e.name,this.due=e.due,this.desc=e.desc,this.priority=e.priority,this.id=e.id,this.completed=!1}}class t{constructor(e,t,o=null){null==o?(this.name=e,this.tasks=[],this.id=t):(this.name=o.name,this.tasks=o.tasks,this.id=o.id)}add_task(e){this.tasks.push(e)}remove_task(e){this.tasks.splice(this.tasks.findIndex((t=>e.id==t.id)),1)}}const o=[];let[n,l]=function(){let e=JSON.parse(localStorage.getItem("projs"));return null==e||0==e.length?[1,-1]:[e[e.length-1].id+1,+localStorage.getItem("task_id")]}(),s=document.querySelector(".projects"),a=document.querySelector("#create-project button"),i=document.querySelector("#create-project input");function c(t){let n=document.createElement("div");n.classList.add("project"),n.id=t.id,s.append(n);let a=document.createElement("span");a.classList.add("title"),a.textContent=t.name;let i=document.createElement("ul");n.append(a,i,function(t){let n=document.createElement("div");n.classList.add("btn-container");let s=document.createElement("button");s.textContent="+ add task";let a=document.createElement("button");return a.textContent="- remove project",a.classList.add("red-button"),n.append(s,a),s.addEventListener("click",(s=>{!function(t,n){let s=document.getElementById(t.id).querySelector("form");null==s?(s=document.createElement("form"),s.innerHTML='\n            <label for="task_name">Name: </label>\n            <input type="text" id="task_name" name="name" value="Ricky">\n            <label for="due">Due: </label>\n            <input type="date" id="due" name="due">\n            <label for="desc">Description: </label>\n            <textarea id="desc" cols="30" rows="10" name="desc"></textarea>\n            <label for="priority">Priority: </label>\n            <select id="priority" name="priority">\n                <option>Low</option>\n                <option selected>Medium</option>\n                <option>High</option>\n            </select>\n            <button>Done</button>\n        ',s.addEventListener("submit",(n=>{n.preventDefault(),d(t,function(t,n){const s=t.querySelector("#task_name").value;let a=t.querySelector("#due").value;""==a&&(a="N/A");const i={name:s,due:a,desc:t.querySelector("#desc").value,priority:t.querySelector("#priority").value,id:l};t.remove();let c=new e(i);return console.log(`YOU JUST CREATED A TASK OF ID ${c.id} FOR PROJECT ${n.id}. WE ADDED TASK OBJECT TO ITS ARRAY`),n.add_task(c),console.log("PROJS:"),console.log(o),l--,localStorage.setItem("task_id",String(l)),localStorage.setItem("projs",JSON.stringify(o)),console.log("STORAGE:"),console.log(localStorage),console.log("------------------------"),c}(s,t))})),n.append(s)):s.classList.toggle("hidden")}(t,n)})),a.addEventListener("click",(e=>{o.splice(o.findIndex((e=>e.id==t.id)),1),document.getElementById(t.id).remove(),localStorage.setItem("projs",JSON.stringify(o)),console.log("YOU JUST DELETED A PROJECT, SO UPDATED PROJS"),console.log("PROJS:"),console.log(o),console.log("STORAGE:"),console.log(localStorage),console.log("------------------------")})),n}(t))}function d(e,t){let n=document.getElementById(e.id).querySelector("ul"),l=document.createElement("li");l.classList.add("task"),l.id=t.id,l.textContent=t.name,l.addEventListener("click",(s=>{const a=`[data-id="${l.id}"]`;let i=n.querySelector(a);if(null==i){i=document.createElement("div"),i.classList.add("task-clicked"),i.dataset.id=l.id;let n=document.createElement("div");n.style.cssText="display: flex; gap: 3px;";let s=document.createElement("button"),a=document.createElement("button");t.completed?(s.textContent="Mark unfinished",s.classList.add("red-button")):s.textContent="Mark finished",a.textContent="Delete task",a.classList.add("red-button");let c=document.createElement("span");c.textContent="Due: "+t.due;let d=document.createElement("span");d.textContent="Description: "+t.desc;let r=document.createElement("span");r.textContent="Priority: "+t.priority;const u=[c,d,r];if(t.completed)for(let e of u)e.classList.toggle("line-through");s.addEventListener("click",(n=>{console.log(`YOU JUST SET TASK OF ID ${t.id} AS COMPLETE FOR PROJECT ${e.id}`),t.completed=!t.completed,localStorage.setItem("projs",JSON.stringify(o)),console.log("STORAGE:"),console.log(localStorage),console.log("------------------------");for(let e of u)e.classList.toggle("line-through");s.classList.toggle("red-button"),s.textContent="Mark finished"==s.textContent?"Mark unfinished":"Mark finished"})),a.addEventListener("click",(n=>{console.log(`YOU JUST DELETED TASK OF ID ${t.id} FOR PROJECT ${e.id}. WE DELETED TASK OBJECT FROM ITS ARRAY`),e.remove_task(t),l.remove(),i.remove(),console.log("PROJS:"),console.log(o),localStorage.setItem("projs",JSON.stringify(o)),console.log("STORAGE:"),console.log(localStorage),console.log("------------------------")})),n.append(s,a),i.append(n,c,d,r),l.insertAdjacentElement("afterend",i)}else i.classList.toggle("hidden")})),n.append(l)}!function(){let e=JSON.parse(localStorage.getItem("projs"));if(null!=e){console.log("PREVIOUS PROJECTS:"),console.log(localStorage);for(let n of e){n=new t(n.name,n.id,n),o.push(n),c(n);for(let e of n.tasks)d(n,e)}}}(),a.addEventListener("click",(e=>{let s;s=""==i.value?new t("untitled project",n):new t(i.value,n),n++,o.push(s),localStorage.setItem("task_id",String(l)),localStorage.setItem("projs",JSON.stringify(o)),c(s)}))})();